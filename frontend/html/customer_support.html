<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer Support</title>
    <link rel="stylesheet" href="../css/styles.css">
</head>
<body>
    <header>
        <div class="logo">
            <img src="images/logo.jpg" alt="SpaceSafe Logo" width="80px" height="50px">
        </div>
        <div class="heading">SpaceSafe</div>
        <nav>
            <a href="#">About Us</a>
            <a href="#">Contact Us</a>
            <a href="storage_location.html">Locations</a>
            <a class="login_btn" href="login_signup_form.html">Login</a>
        </nav>
    </header>
    <h1 class="customer_heading">Customer Support</h1>
    <table>
        <tr>
            <th>Storage Unit</th>
            <th>Unit 1</th>
            <th>Unit 2</th>
            <th>Unit 3</th>
            <th>Unit 4</th>
            <th>Unit 5</th>
        </tr>
        
        <!-- JOHANNESBURG -->
        <!-- rosebank -->
        <tr>
            <td>Rosebank</td>
            <td>
                <select class="dropdown status-available" onchange="updateStatus(this, 'Rosebank', 'Unit 1')">
                    <option value="Available" class="status-available">Available</option>
                    <option value="Reserved" class="status-reserved">Reserved</option>
                    <option value="Cancelling" class="status-cancelling">Cancelling</option>
                    <option value="Problem" class="status-problem">Problem</option>
                    <option value="Unavailable" class="status-unavailable">Unavailable</option>
                </select>
            </td>
            <td>
                <select class="dropdown status-cancelling" onchange="updateStatus(this, 'Rosebank', 'Unit 2')">
                    <option value="Available" class="status-available">Available</option>
                    <option value="Reserved" class="status-reserved">Reserved</option>
                    <option value="Cancelling" class="status-cancelling">Cancelling</option>
                    <option value="Problem" class="status-problem">Problem</option>
                    <option value="Unavailable" class="status-unavailable">Unavailable</option>
                </select>
            </td>
            <td>
                <select class="dropdown status-reserved" onchange="updateStatus(this, 'Rosebank', 'Unit 3')">
                    <option value="Available" class="status-available">Available</option>
                    <option value="Reserved" class="status-reserved">Reserved</option>
                    <option value="Cancelling" class="status-cancelling">Cancelling</option>
                    <option value="Problem" class="status-problem">Problem</option>
                    <option value="Unavailable" class="status-unavailable">Unavailable</option>
                </select>
            </td>
            <td>
                <select class="dropdown status-problem" onchange="updateStatus(this, 'Rosebank', 'Unit 4')">
                    <option value="Available" class="status-available">Available</option>
                    <option value="Reserved" class="status-reserved">Reserved</option>
                    <option value="Cancelling" class="status-cancelling">Cancelling</option>
                    <option value="Problem" class="status-problem">Problem</option>
                    <option value="Unavailable" class="status-unavailable">Unavailable</option>
                </select>
            </td>
            <td>
                <select class="dropdown status-available" onchange="updateStatus(this, 'Rosebank', 'Unit 5')">
                    <option value="Available" class="status-available">Available</option>
                    <option value="Reserved" class="status-reserved">Reserved</option>
                    <option value="Cancelling" class="status-cancelling">Cancelling</option>
                    <option value="Problem" class="status-problem">Problem</option>
                    <option value="Unavailable" class="status-unavailable">Unavailable</option>
                </select>
            </td>
        </tr>
       
        <!-- melrose -->
        <tr>
            <td>Melrose</td>
            <td>
                <select class="dropdown status-available" onchange="updateStatus(this, 'Rosebank', 'Unit 1')">
                    <option value="Available" class="status-available">Available</option>
                    <option value="Reserved" class="status-reserved">Reserved</option>
                    <option value="Cancelling" class="status-cancelling">Cancelling</option>
                    <option value="Problem" class="status-problem">Problem</option>
                    <option value="Unavailable" class="status-unavailable">Unavailable</option>
                </select>
            </td>
            <td>
                <select class="dropdown status-cancelling" onchange="updateStatus(this, 'Rosebank', 'Unit 2')">
                    <option value="Available" class="status-available">Available</option>
                    <option value="Reserved" class="status-reserved">Reserved</option>
                    <option value="Cancelling" class="status-cancelling">Cancelling</option>
                    <option value="Problem" class="status-problem">Problem</option>
                    <option value="Unavailable" class="status-unavailable">Unavailable</option>
                </select>
            </td>
            <td>
                <select class="dropdown status-reserved" onchange="updateStatus(this, 'Rosebank', 'Unit 3')">
                    <option value="Available" class="status-available">Available</option>
                    <option value="Reserved" class="status-reserved">Reserved</option>
                    <option value="Cancelling" class="status-cancelling">Cancelling</option>
                    <option value="Problem" class="status-problem">Problem</option>
                    <option value="Unavailable" class="status-unavailable">Unavailable</option>
                </select>
            </td>
            <td>
                <select class="dropdown status-problem" onchange="updateStatus(this, 'Rosebank', 'Unit 4')">
                    <option value="Available" class="status-available">Available</option>
                    <option value="Reserved" class="status-reserved">Reserved</option>
                    <option value="Cancelling" class="status-cancelling">Cancelling</option>
                    <option value="Problem" class="status-problem">Problem</option>
                    <option value="Unavailable" class="status-unavailable">Unavailable</option>
                </select>
            </td>
            <td>
                <select class="dropdown status-available" onchange="updateStatus(this, 'Rosebank', 'Unit 5')">
                    <option value="Available" class="status-available">Available</option>
                    <option value="Reserved" class="status-reserved">Reserved</option>
                    <option value="Cancelling" class="status-cancelling">Cancelling</option>
                    <option value="Problem" class="status-problem">Problem</option>
                    <option value="Unavailable" class="status-unavailable">Unavailable</option>
                </select>
            </td>
        </tr>

        <!-- CAPETOWN -->
        <!-- century city -->
        <tr>
            <td>Century City</td>
            <td>
                <select class="dropdown status-available" onchange="updateStatus(this, 'Rosebank', 'Unit 1')">
                    <option value="Available" class="status-available">Available</option>
                    <option value="Reserved" class="status-reserved">Reserved</option>
                    <option value="Cancelling" class="status-cancelling">Cancelling</option>
                    <option value="Problem" class="status-problem">Problem</option>
                    <option value="Unavailable" class="status-unavailable">Unavailable</option>
                </select>
            </td>
            <td>
                <select class="dropdown status-cancelling" onchange="updateStatus(this, 'Rosebank', 'Unit 2')">
                    <option value="Available" class="status-available">Available</option>
                    <option value="Reserved" class="status-reserved">Reserved</option>
                    <option value="Cancelling" class="status-cancelling">Cancelling</option>
                    <option value="Problem" class="status-problem">Problem</option>
                    <option value="Unavailable" class="status-unavailable">Unavailable</option>
                </select>
            </td>
            <td>
                <select class="dropdown status-reserved" onchange="updateStatus(this, 'Rosebank', 'Unit 3')">
                    <option value="Available" class="status-available">Available</option>
                    <option value="Reserved" class="status-reserved">Reserved</option>
                    <option value="Cancelling" class="status-cancelling">Cancelling</option>
                    <option value="Problem" class="status-problem">Problem</option>
                    <option value="Unavailable" class="status-unavailable">Unavailable</option>
                </select>
            </td>
            <td>
                <select class="dropdown status-problem" onchange="updateStatus(this, 'Rosebank', 'Unit 4')">
                    <option value="Available" class="status-available">Available</option>
                    <option value="Reserved" class="status-reserved">Reserved</option>
                    <option value="Cancelling" class="status-cancelling">Cancelling</option>
                    <option value="Problem" class="status-problem">Problem</option>
                    <option value="Unavailable" class="status-unavailable">Unavailable</option>
                </select>
            </td>
            <td>
                <select class="dropdown status-available" onchange="updateStatus(this, 'Rosebank', 'Unit 5')">
                    <option value="Available" class="status-available">Available</option>
                    <option value="Reserved" class="status-reserved">Reserved</option>
                    <option value="Cancelling" class="status-cancelling">Cancelling</option>
                    <option value="Problem" class="status-problem">Problem</option>
                    <option value="Unavailable" class="status-unavailable">Unavailable</option>
                </select>
            </td>
        </tr>
 
        <!-- maynard mall -->
        <tr>
            <td>Maynard Mall</td>
            <td>
                <select class="dropdown status-available" onchange="updateStatus(this, 'Rosebank', 'Unit 1')">
                    <option value="Available" class="status-available">Available</option>
                    <option value="Reserved" class="status-reserved">Reserved</option>
                    <option value="Cancelling" class="status-cancelling">Cancelling</option>
                    <option value="Problem" class="status-problem">Problem</option>
                    <option value="Unavailable" class="status-unavailable">Unavailable</option>
                </select>
            </td>
            <td>
                <select class="dropdown status-cancelling" onchange="updateStatus(this, 'Rosebank', 'Unit 2')">
                    <option value="Available" class="status-available">Available</option>
                    <option value="Reserved" class="status-reserved">Reserved</option>
                    <option value="Cancelling" class="status-cancelling">Cancelling</option>
                    <option value="Problem" class="status-problem">Problem</option>
                    <option value="Unavailable" class="status-unavailable">Unavailable</option>
                </select>
            </td>
            <td>
                <select class="dropdown status-reserved" onchange="updateStatus(this, 'Rosebank', 'Unit 3')">
                    <option value="Available" class="status-available">Available</option>
                    <option value="Reserved" class="status-reserved">Reserved</option>
                    <option value="Cancelling" class="status-cancelling">Cancelling</option>
                    <option value="Problem" class="status-problem">Problem</option>
                    <option value="Unavailable" class="status-unavailable">Unavailable</option>
                </select>
            </td>
            <td>
                <select class="dropdown status-problem" onchange="updateStatus(this, 'Rosebank', 'Unit 4')">
                    <option value="Available" class="status-available">Available</option>
                    <option value="Reserved" class="status-reserved">Reserved</option>
                    <option value="Cancelling" class="status-cancelling">Cancelling</option>
                    <option value="Problem" class="status-problem">Problem</option>
                    <option value="Unavailable" class="status-unavailable">Unavailable</option>
                </select>
            </td>
            <td>
                <select class="dropdown status-available" onchange="updateStatus(this, 'Rosebank', 'Unit 5')">
                    <option value="Available" class="status-available">Available</option>
                    <option value="Reserved" class="status-reserved">Reserved</option>
                    <option value="Cancelling" class="status-cancelling">Cancelling</option>
                    <option value="Problem" class="status-problem">Problem</option>
                    <option value="Unavailable" class="status-unavailable">Unavailable</option>
                </select>
            </td>
        </tr>
    </table>

    <script>
        async function updateStatus(dropdown, location, unit) {
            // Remove existing status class
            dropdown.className = "dropdown";

            // Get selected status value
            const status = dropdown.value;

            // Add the corresponding class to the dropdown
            if (status === "Available") {
                dropdown.classList.add("status-available");
            } else if (status === "Reserved") {
                dropdown.classList.add("status-reserved");
            } else if (status === "Cancelling") {
                dropdown.classList.add("status-cancelling");
            } else if (status === "Problem") {
                dropdown.classList.add("status-problem");
            } else if (status === "Unavailable") {
                dropdown.classList.add("status-unavailable");
            }

            // Send the status update to the Lambda function
            const response = await fetch('https://your-api-endpoint', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${userToken}` // Ensure userToken is set
                },
                body: JSON.stringify({
                    action: 'update_status',
                    unit_id: `${location}-${unit}`,
                    new_status: status
                })
            });

            const data = await response.json();
            if (!response.ok) {
                alert('Error: ' + data.message);
            } else {
                alert('Status updated successfully!');
            }
        }
    </script>
</body>
</html>